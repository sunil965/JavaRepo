package com.bridgelabz.database;

import java.sql.DriverManager;

import com.mysql.jdbc.Connection;
import com.mysql.jdbc.PreparedStatement;
import com.mysql.jdbc.ResultSet;
import com.mysql.jdbc.Statement;

public class PreparedStatementDemo {

	
	public static void main(String[] args) throws Exception {
		Class.forName("com.mysql.jdbc.Driver");
		
		String url = "jdbc:mysql://localhost:3306/AddressBook";
		Connection conn = (Connection) DriverManager.getConnection(url,"root","password");
		
		String query = "insert into Registration values(?,?,?,?)";
		PreparedStatement pstmt = conn.clientPrepareStatement(query);
		
		pstmt.setInt(1,105);
		pstmt.setString(2, "Rajiv");
		pstmt.setString(3, "Dixit");
		pstmt.setLong(4,789456622);
		pstmt.executeUpdate();
		
		 Statement stmt = (Statement) conn.createStatement();
	     String query2 = "select * from Registration";
	     ResultSet rs =  (ResultSet) stmt.executeQuery(query);
	     System.out.println("ID \tFIRSTNAME \tLASTNAME \tCONTACT");
		 System.out.println("***************************************************");
	      
	      while (rs.next()) {
	         int id = rs.getInt("id");
	         String name = rs.getString("name");
	         String job = rs.getString("job");
	         System.out.println(id + "  " + name+"   "+job);
	      } 

	}

}
