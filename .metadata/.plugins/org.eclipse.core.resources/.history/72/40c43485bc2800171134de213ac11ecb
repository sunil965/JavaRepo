package com.bridgelabz.database;

import java.sql.DriverManager;

import com.mysql.jdbc.Connection;
import com.mysql.jdbc.PreparedStatement;
import com.mysql.jdbc.ResultSet;
import com.mysql.jdbc.Statement;

public class PreparedStatementDemo {

	
	public static void main(String[] args) throws Exception {
		Class.forName("com.mysql.jdbc.Driver");
			String url = "jdbc:mysql://localhost:3306/AddressBook";
		Connection conn = (Connection) DriverManager.getConnection(url,"root","password");
			String query = "insert into Registration values(?,?,?,?)";
		PreparedStatement pstmt = conn.clientPrepareStatement(query);
		
		/*pstmt.setInt(1,107);
		pstmt.setString(2, "Manoj");
		pstmt.setString(3, "Singh");
		pstmt.setInt(4,749456202);*/
		pstmt.executeUpdate("insert into Registration values(108,'amit','singh',789456130)");
		
//		 Statement stmt = (Statement) conn.createStatement();
	     String query2 = "select * from Registration";
	     ResultSet rs =  (ResultSet) pstmt.executeQuery(query2);
	     System.out.println("ID  FIRSTNAME LASTNAME  CONTACT");
		 System.out.println("***************************************************");
		 
		 /*while (rs.next()) {
				System.out.println(rs.getInt(1) + " \t" +
				 				   rs.getString(2) + " \t\t" + 
				 				   rs.getString(3) + " \t\t" + 
				 				   rs.getLong(4));
			}*/
	      
	      while (rs.next()) {
	         int id = rs.getInt("id");
	         String fname = rs.getString("firstname");
	         String lname = rs.getString("lastname");
	         Long contact = rs.getLong("contact");
	         System.out.println(id + "\t" + fname+"\t"+lname+"\t"+contact);
	      } 

	}

}
